import{j as s,d as W,r,n as R,B as N,o as M,t as c}from"./main--65lMR06.js";import{C as H,a as F,b as k,c as q,d as E,L as S,W as _,e as w,w as j,p as y}from"./WRAudio-f-HJCqlp.js";import{_ as I,o as $,p as B,q as D,r as L,i as T,k as U,j as Q,l as V}from"./rust_wasm-DLjsnXOY.js";function v({className:e,type:i,...l}){return s.jsx("input",{type:i,"data-slot":"input",className:W("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...l})}const h={str:{sha256:V,sha256WithSalt:Q,sha512:U,sha512WithSalt:T},bytes:{sha256:L,sha256WithSalt:D,sha512:B,sha512WithSalt:$}};async function z(e,i,l){if(!h[e])throw new Error(`Valid inPage is required, but got ${e}`);try{const t="test",n=h[e].sha256(t),u=h[e].sha256WithSalt(t,i);if(n!==u)return!1;const o=h[e].sha512(t),f=h[e].sha512WithSalt(t,l);return o===f}catch(t){return console.error("答案验证过程中出错",t),c.error(`答案验证过程中出错：${t}`),!1}}function O({inPage:e,onCorrectAnswer:i}){const[l,t]=r.useState(!1),[n,u]=r.useState(""),[o,f]=r.useState(""),[d,m]=r.useState(!1),[C,p]=r.useState(!1),x=r.useRef(null),b=r.useRef(null);r.useEffect(()=>{async function a(){if(!l)try{await I(),t(!0)}catch(g){console.error("WASM 初始化失败",g),c.error("WASM 初始化失败",{description:g.toString()})}}a()},[l]);const A=async()=>{if(!n.trim()||!o.trim()){c.warning("请输入两个盐值");return}m(!0);try{await z(e,n.trim(),o.trim())?(y(x,w),p(!0),c.success("恭喜你！答案正确！",{description:"你成功找到了默认盐值！"}),i&&i(),setTimeout(()=>p(!1),3e3)):(y(b,j),c.error("答案错误",{description:"请再接再厉qwq"}))}catch(a){console.error("验证过程中出错",a),c.error(`验证过程中出错：${a}`)}finally{m(!1)}};return s.jsxs("div",{children:[C&&s.jsx(H,{}),s.jsxs(F,{className:"w-full",children:[s.jsxs(k,{children:[s.jsxs(q,{className:"flex items-center gap-2 text-xl",children:[s.jsx(R,{}),"逆向挑战"]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"通过逆向，找到“SHA256+默认盐”和“SHA512+默认盐”中默认盐的值。"})]}),s.jsx(E,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(S,{htmlFor:"sha256-salt",children:"SHA256 默认盐值"}),s.jsx(v,{id:"sha256-salt",value:n,onChange:a=>u(a.target.value),placeholder:"请输入 SHA256 的默认盐值",className:"font-mono",disabled:d})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(S,{htmlFor:"sha512-salt",children:"SHA512 默认盐值"}),s.jsx(v,{id:"sha512-salt",value:o,onChange:a=>f(a.target.value),placeholder:"请输入 SHA512 的默认盐值",className:"font-mono",disabled:d})]}),s.jsx(N,{onClick:A,disabled:d||!n.trim()||!o.trim(),className:W("w-full flex gap-2",d&&"opacity-50 cursor-not-allowed"),children:d?s.jsxs(s.Fragment,{children:[s.jsx(M,{className:"animate-spin w-4 h-4"}),"验证中..."]}):"提交"})]})})]}),s.jsx(_,{ref:x,src:w}),s.jsx(_,{ref:b,src:j})]})}export{O as A,v as I};
