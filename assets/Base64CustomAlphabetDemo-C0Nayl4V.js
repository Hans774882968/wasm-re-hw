import{r as a,j as e,n as q,B as j,d as L,o as H,t as x,m as Q,p as G,k as J,q as y,s as K,v as g}from"./main--65lMR06.js";import{C as P,a as _,b as A,c as R,d as W,L as i,T as o,W as C,e as S,w as k,p as B}from"./WRAudio-f-HJCqlp.js";import{_ as V,e as E,c as O,d as X,f as Y}from"./rust_wasm-DLjsnXOY.js";async function Z(c){if(!c||c.length!==64)return!1;try{const t="爱拼才会赢💪",d=E(t),n=O(t,c);return d===n}catch(t){return console.error("验证 Base64 码表时出错",t),!1}}function $({onCorrectAnswer:c}){const[t,d]=a.useState(!1),[n,m]=a.useState(""),[l,b]=a.useState(!1),[u,w]=a.useState(!1),f=a.useRef(null),N=a.useRef(null);a.useEffect(()=>{async function r(){if(!t)try{await V(),d(!0)}catch(h){console.error("WASM 初始化失败",h),x.error("WASM 初始化失败",{description:h.toString()})}}r()},[t]);const p=async()=>{b(!0);try{await Z(n.trim())?(B(f,S),w(!0),x.success("恭喜你！答案正确！",{description:"你成功逆向出了默认 Base64 码表！"}),c&&c(),setTimeout(()=>w(!1),3e3)):(B(N,k),x.error("答案错误",{description:"请再接再厉qwq"}))}catch(r){console.error("验证过程中出错",r),x.error(`验证过程中出错：${r}`)}finally{b(!1)}};return e.jsxs("div",{children:[u&&e.jsx(P,{}),e.jsxs(_,{className:"w-full",children:[e.jsxs(A,{children:[e.jsxs(R,{className:"flex items-center gap-2 text-xl",children:[e.jsx(q,{}),"逆向挑战"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"通过前端逆向，找出《固定码表（预设）》所使用的码表。"})]}),e.jsx(W,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"base64-alphabet",children:"Base64 码表"}),e.jsx(o,{id:"base64-alphabet",value:n,onChange:r=>m(r.target.value),placeholder:"请输入 64 个字符的码表，例如 ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",className:"font-mono min-h-[100px]",disabled:l})]}),e.jsx(j,{onClick:p,disabled:l||!n.trim(),className:L("w-full flex gap-2",l&&"opacity-50 cursor-not-allowed"),children:l?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"animate-spin w-4 h-4"}),"验证中..."]}):"提交"})]})})]}),e.jsx(C,{ref:f,src:S}),e.jsx(C,{ref:N,src:k})]})}function F({title:c,description:t,encodeFn:d,decodeFn:n,hasAlphabet:m=!1}){const[l,b]=a.useState(""),[u,w]=a.useState(""),[f,N]=a.useState("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),[p,r]=a.useState(""),[h,D]=a.useState(""),[v,M]=a.useState("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),I=()=>{try{const s=m?d(l,f):d(l);w(s)}catch(s){x.error("编码失败",{description:s.toString()})}},T=()=>{try{const s=m?n(p,v):n(p);D(s)}catch(s){x.error("解码失败",{description:s.toString()})}},U=()=>{g(u)},z=()=>{g(h)};return e.jsxs(_,{className:"w-full",children:[e.jsxs(A,{children:[e.jsxs(R,{className:"flex items-center gap-2 text-xl",children:[e.jsx(G,{className:"w-6 h-6"}),c]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t})]}),e.jsx(W,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"原始字符串"}),e.jsx(o,{value:l,onChange:s=>b(s.target.value),placeholder:"请输入要编码的原始字符串",className:"font-mono min-h-[100px] whitespace-pre-wrap break-all"})]}),m&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Base64 码表（编码用）"}),e.jsx(o,{value:f,onChange:s=>N(s.target.value),placeholder:"64 个字符的自定义码表",className:"font-mono min-h-[80px] whitespace-pre-wrap break-all"})]}),e.jsxs(j,{size:"sm",disabled:!l.trim(),onClick:I,className:"w-full flex gap-1",children:[e.jsx(J,{className:"w-4 h-4"}),"编码"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(i,{children:"编码结果"}),e.jsx(j,{variant:"ghost",size:"sm",onClick:U,disabled:!u.trim(),className:"h-7 px-2",children:e.jsx(y,{className:"w-3.5 h-3.5"})})]}),e.jsx(o,{value:u,placeholder:"编码结果将显示在此",className:"font-mono min-h-[100px] whitespace-pre-wrap break-all",readOnly:!0})]})]}),e.jsx("div",{className:"w-full h-px md:h-auto md:w-px bg-border my-2 md:my-0 md:mx-3","aria-hidden":"true"}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"编码字符串"}),e.jsx(o,{value:p,onChange:s=>r(s.target.value),placeholder:"请输入要解码的 Base64 字符串",className:"font-mono min-h-[100px] whitespace-pre-wrap break-all"})]}),m&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Base64 码表（解码用）"}),e.jsx(o,{value:v,onChange:s=>M(s.target.value),placeholder:"64 个字符的自定义码表",className:"font-mono min-h-[80px] whitespace-pre-wrap break-all"})]}),e.jsxs(j,{size:"sm",disabled:!p.trim(),onClick:T,className:"w-full flex gap-1",children:[e.jsx(K,{className:"w-4 h-4"}),"解码"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(i,{children:"解码结果"}),e.jsx(j,{variant:"ghost",size:"sm",onClick:z,disabled:!h.trim(),className:"h-7 px-2",children:e.jsx(y,{className:"w-3.5 h-3.5"})})]}),e.jsx(o,{value:h,placeholder:"解码结果将显示在此",className:"font-mono min-h-[100px] whitespace-pre-wrap break-all",readOnly:!0})]})]})]})})]})}function te(){return e.jsxs(Q.div,{className:"max-w-6xl mx-auto p-4 md:p-8 space-y-4 md:space-y-8",initial:"hidden",animate:"visible",variants:{hidden:{},visible:{transition:{staggerChildren:.2}}},children:[e.jsx(F,{title:"固定码表（预设）",description:"使用 Rust WASM 模块内置的自定义 Base64 码表进行编解码",encodeFn:E,decodeFn:X,hasAlphabet:!1}),e.jsx(F,{title:"动态码表（运行时指定）",description:"在运行时传入任意 64 字符 Base64 码表进行编解码",encodeFn:O,decodeFn:Y,hasAlphabet:!0}),e.jsx($,{})]})}export{te as default};
